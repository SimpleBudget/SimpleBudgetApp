<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="partials :: head('Your Profile ')">

</head>
<body>
<nav th:replace="partials :: navbar"/>
<h1>User information</h1>
<h2 th:text="${user.username}"></h2>
<h2 th:text="${user.email}"></h2>
<h2 th:text="${user.phonenumber}"></h2>



<h3 th:if="${account != null}">Your monthly income</h3>
<p th:if="${account != null}" id="monthlyIncome" th:text="${account.getIncome()}"></p>

<h3 th:if="${bills.size() >= 1}">Your bills</h3>
<div th:each="bill : ${bills}">
    <h4 th:text="${bill.name}"></h4>
    <p th:text="${bill.amount}"></p>
    <hr />
</div>
<h3 th:if="${billTotal > 0}">Total of your Bills</h3>
<p th:if="${billTotal > 0}" id="billTotal" th:text="${billTotal}"></p>
<h3 th:if="${billTotal > 0}">Money left over after your bills</h3>
<p th:if="${billTotal > 0}" id="moneyAfterBills" th:text="${moneyAfterBills}"></p>
<a href="/account-setup"><button th:if="${account == null}">setup your account!</button></a>
<a href="/account-setup"><button th:if="${account != null}">edit your account!</button></a>
<h3 th:if="${billTotal > 0}">Calculate what you can spend per day after bills!</h3>

<h4 th:if="${billTotal > 0}" id="spendAmount"></h4>

<h4 th:if="${account != null &amp;&amp; account.option == 1 &amp;&amp; bills.size() >= 1}"   th:text="'You need to save: ' + ${billTotal/4} + ' per paycheck.'"></h4>
<h4 th:if="${account != null &amp;&amp; account.option == 2 &amp;&amp; bills.size() >= 1}"   th:text="'You need to save: ' + ${billTotal/2} + ' per paycheck.'"></h4>
<h4 th:if="${account != null &amp;&amp; account.option == 3 &amp;&amp; bills.size() >= 1}"   th:text="'You need to save: ' + ${billTotal}  + ' per paycheck.'"></h4>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        let moneyAfterBills = document.getElementById("moneyAfterBills");
        let moneyAfterBillsNumber = Number(moneyAfterBills.innerText);
        let spendAmount = document.getElementById("spendAmount");
        let amount = (moneyAfterBillsNumber/28);
        spendAmount.innerText = "You can spend " + amount.toFixed(2) + " per day.";
        let billTotal = document.getElementById("billTotal");

    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {

        var data = google.visualization.arrayToDataTable([
            ['Monthly Income', 'Expenses'],
            ['Total of bills', Number(billTotal.innerText)],
            ['Daily Spending', moneyAfterBillsNumber]
            // ['Commute',  2],
            // ['Watch TV', 2],
            // ['Sleep',    7]
        ]);

        var options = {
            title: 'Monthly Income Broken Down'
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart'));

        chart.draw(data, options);
    }
</script>
<div id="piechart" style="width: 900px; height: 500px;"></div>

</body>
<footer th:replace="partials :: footer"/>

</html>